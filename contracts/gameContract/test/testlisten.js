var Web3 = require('web3');

let host = "http://192.168.0.212:8545";
var web3 = new Web3(new Web3.providers.HttpProvider(host));

var abi=[{"constant":false,"inputs":[{"name":"_name","type":"string"},{"name":"_contract","type":"address"}],"name":"set","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_name","type":"string"}],"name":"get","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"}];var contract="0x1000000000000000000000000000000000000003";var register= web3.eth.contract(abi).at(contract);

var gameabi= [{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"_setPayer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"authorityAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"addr","type":"address"}],"name":"_setContract","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_grant","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"games","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"price","type":"uint256"},{"name":"gaslimit","type":"uint64"}],"name":"_setGas","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"tokenAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_setauthority","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"}],"name":"_getContract","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_revoke","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"tableMgrAddr","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Transfer","type":"event"},{"constant":false,"inputs":[],"name":"leave","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setauthority","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setToken","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_value","type":"uint256"},{"name":"_data","type":"bytes"}],"name":"tokenFallback","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"roomAddress","type":"address"}],"name":"setRoomMgr","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tableAddress","type":"address"}],"name":"setTableMgr","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"from","type":"address"},{"name":"to","type":"address"},{"name":"value","type":"uint256"}],"name":"transferToken","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]

var croomabi = [{"constant":true,"inputs":[],"name":"notaryManage","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"_setPayer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"authorityAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"addr","type":"address"}],"name":"_setContract","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_grant","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"luaAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"interManage","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"price","type":"uint256"},{"name":"gaslimit","type":"uint64"}],"name":"_setGas","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"tokenAddress","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_setauthority","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"}],"name":"_getContract","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"_revoke","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"currMaxTbNum","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"minimum_","type":"uint32"},{"name":"maximum_","type":"uint32"},{"name":"smallBlind_","type":"uint256"},{"name":"needChips_","type":"uint256"},{"name":"zone_","type":"uint8"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"roomAddr","type":"address"}],"name":"JoinSittingQueen","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"tableid","type":"uint256"},{"indexed":false,"name":"addr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"Join","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tableid","type":"uint256"}],"name":"AllotTable","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"tbNum","type":"uint256"},{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"}],"name":"LeaveTable","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tbNum","type":"uint256"},{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"Start","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tbNum","type":"uint256"},{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"SelectStarter","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tbid","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"GameStart","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tbNum","type":"uint256"},{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"StartGame","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tbNum","type":"uint256"},{"indexed":false,"name":"playerAddr","type":"address"},{"indexed":false,"name":"pos","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"Discard","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"nrAddr","type":"address"},{"indexed":false,"name":"datalength","type":"uint256"},{"indexed":false,"name":"data","type":"bytes"}],"name":"SubmmitSettleData","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tableId","type":"uint256"},{"indexed":false,"name":"datasrc","type":"uint8"},{"indexed":false,"name":"errcode","type":"uint8"}],"name":"SettleError","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"roomAddr","type":"address"},{"indexed":false,"name":"tableId","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"},{"indexed":false,"name":"pos","type":"uint8"},{"indexed":false,"name":"flag","type":"uint8"},{"indexed":false,"name":"amount","type":"uint256"}],"name":"SettleItemData","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"hand","type":"uint256"},{"indexed":false,"name":"playingNum","type":"uint256"},{"indexed":false,"name":"tableid","type":"uint256"}],"name":"Settle","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"tableid","type":"uint256"},{"indexed":false,"name":"number","type":"uint256"}],"name":"SelectInter","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"tableid","type":"uint256"},{"indexed":false,"name":"hand","type":"uint256"}],"name":"FinishNotary","type":"event"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setluaAddress","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setauthority","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setTokenAddr","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setInterAddr","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setNotaryAddr","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"addr","type":"address"}],"name":"setRoomFunAddr","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getRoomInfo","outputs":[{"name":"","type":"uint32"},{"name":"","type":"uint32"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getSittingQueen","outputs":[{"name":"","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"}],"name":"getTableInfo","outputs":[{"name":"","type":"uint256"},{"name":"","type":"uint32"},{"name":"","type":"uint8"},{"name":"","type":"uint256"},{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"pagenum","type":"uint256"},{"name":"pagesize","type":"uint256"}],"name":"getTableList","outputs":[{"name":"len","type":"uint256"},{"name":"tblist","type":"uint256[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"}],"name":"getTablePlayers","outputs":[{"name":"players","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"}],"name":"getTablePlayingPlayers","outputs":[{"name":"number","type":"uint256"},{"name":"players","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"playerAddr","type":"address"}],"name":"getPlayerInfo","outputs":[{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"},{"name":"pos","type":"uint8"}],"name":"getTableSeatInfo","outputs":[{"name":"","type":"address"},{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"}],"name":"getTableStartPlayer","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"tableid","type":"uint256"}],"name":"joinTable","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"cancelSitting","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"leaveTable","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"leaveRoom","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tableId","type":"uint256"},{"name":"hand","type":"uint32"}],"name":"startGame","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tableId","type":"uint256"},{"name":"hand","type":"uint32"}],"name":"start","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"hand","type":"uint256"}],"name":"discard","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"data","type":"bytes"}],"name":"discard2","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"data","type":"bytes"}],"name":"playerSettle","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tableid","type":"uint256"},{"name":"data","type":"bytes"}],"name":"submitNotary","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"tableId","type":"uint256"}],"name":"getSubNotorys","outputs":[{"name":"addrs","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"tableId","type":"uint256"}],"name":"resetNotoryInfo","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"number","type":"uint256"}],"name":"applyInter","outputs":[{"name":"ret","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"number","type":"uint256"}],"name":"applyNotarize","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"tableid","type":"uint256"}],"name":"finishNotarize","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"}]

var croom=web3.eth.contract(croomabi).at(register.get("RoomManager"))
var game = web3.eth.contract(gameabi).at(croom.tokenAddress())


var evt = croom.LeaveTable()
evt.watch(function(err, result) {
    if (!err) {
        console.log(result.transactionHash);
       
    } else {
        console.log(err);
    }
});